---
---
{% include header.html %}
<div class="document">


<div class="section" id="getting-started">
<h1>Getting started for sysadmins</h1>
<p>This guide will walk you through the setup process to get NIPAP up and
running on a Debian 7.0 (wheezy) or Ubuntu 12.04 or later system.  With no
prior experience it should take about 15 minutes.</p>
<p>Debian and Debian derivatives (primarily Ubuntu) are the only distributions
supported at this time. It is certainly possible to install on other Linux
flavours or other UNIX-style operating systems, but there are no packages and
currently no instructions. We were hoping to provide .rpms, but given the large
amount of dependencies missing in RHEL and the added complexity in the package
build process, this has yet to happen.</p>
</div>
<div class="section" id="debian-installation">
<h1>Debian installation</h1>
<p>Add the NIPAP repo to your package sources and update your lists:</p>
<pre class="literal-block">
echo &quot;deb http://spritelink.github.io/NIPAP/repos/apt stable main extra&quot; &gt; /etc/apt/sources.list.d/nipap.list
apt-get update
</pre>
<p>There are now five new nipap related packages:</p>
<pre class="literal-block">
root&#64;debian:~# apt-cache search nipap
nipap-cli - Neat IP Address Planner
nipap-common - Neat IP Address Planner
nipap-www - web frontend for NIPAP
nipapd - Neat IP Address Planner XML-RPC daemon
python-pynipap - Python module for accessing NIPAP
root&#64;debian:~#
</pre>
<p>'nipapd' contains the XML-RPC middleware daemon which is a required component
in the NIPAP suite. It's the glue between the database and the rest of the
world. 'nipap-common' is a library with common stuff needed by all the other
components, so regardless which one you choose, you will get this one.
'nipap-cli' is, not very surprisingly, a CLI client for NIPAP while 'nipap-www'
is the web GUI. Choose your favourite interface or both and install it, you
will automatically get 'python-pynipap' which is a client-side library for
Python applications and since both the web GUI and CLI client is written in
Python, you will need 'python-pynipap'. If you want, you can install the nipapd
middleware on one machine and the CLI and/or web on another.</p>
<p>Let's install the backend as well as the CLI and web UI:</p>
<pre class="literal-block">
apt-get install nipapd nipap-cli nipap-www
</pre>
<p>apt-get will complain about that the packages cannot be authenticated. This is
due to the reason that the NIPAP Debian repository is not signed. Ignore the
warning and type 'y' to continue. During installation, the nipapd package will
ask if you want to automatically load the needed database structure and start
nipapd on startup - answer Yes to both questions. After the installation is
done, you will have the PostgreSQL database server and all the other necessary
dependancies installed. Edit /etc/postgresql/9.1/main/postgresql.conf and
change uncomment the listen_address line so that it listens to localhost.</p>
</div>
<div class="section" id="cli-configuration">
<h1>CLI configuration</h1>
<p>This is pretty easy, once you have the nipap-cli package installed, a new
command, 'nipap', is available to you. It reads .nipaprc in your home directory
and expects to find things like the host address of nipapd and the
authentication credentials.</p>
<p>Create a new used in the local authentication database for the CLI:</p>
<pre class="literal-block">
nipap-passwd -a cli -p secret -n "My CLI user"
</pre>
<p>Here's an example .nipaprc that will work towards localhost with the user
just created: </p>
<pre class="literal-block">
[global]
hostname = localhost
port     = 1337
username = cli
password = secret
default_vrf = none
</pre>
<p>The last option sets which VRF is the default to work with if nothing
else is set.</p>
<p>Let's try adding a prefix too:</p>
<pre class="literal-block">
nipap address add prefix 192.0.2.0/24 type assignment description &quot;test prefix&quot;
</pre>
<p>And list everything covered by 0.0.0.0/0:</p>
<pre class="literal-block">
nipap address list 0/0
</pre>
</div>
<div class="section" id="installation-of-the-web-ui">
<h1>Installation of the web UI</h1>
<p>The NIPAP web UI performs all operations through the NIPAP XML-RPC API served
by nipapd, which means they do not need to be installed on the same machine. It
is built on the Pylons web framework and requires Pylons version &gt;= 1.0. This
version has unfortunately not yet made it into neither the Debian nor the
Ubuntu official repositories yet. For you lycky enough to run an apt-based
distribution, there is a Pylons 1.0 package in the NIPAP 'extra' repository
which should work on any apt-based system running python 2.5, 2.6 or 2.7.  See
how to enable the 'extra' repo under the ip4r-section above. With the 'extra'
repository enabled, the NIPAP web UI is installed using the following command:</p>
<pre class="literal-block">
apt-get install nipap-www
</pre>
<p>When apt-get has completed the installation, you should have all dependencies
required for the NIPAP web UI as well as the web UI itself installed.</p>
</div>
<div class="section" id="configuration-of-the-web-ui">
<h1>Configuration of the web UI</h1>
<p>Begin by adding a user for the web interface to the local authentication
database on the server where nipapd is running:</p>
<pre class="literal-block">
nipap-passwd -a *username* -p *password* -n 'NIPAP web UI' -t
</pre>
<p>The '-t' option tells nipap-passwd to make the new user a 'trusted' user, that
is a user which can authenticate against nipapd using one username but log all
changes as made by another user. See the docs for the NIPAP authentication
library for more information about this:
<a class="reference external" href="http://spritelink.github.io/NIPAP/nipap/authlib.html">http://spritelink.github.io/NIPAP/nipap/authlib.html</a></p>
<p>Now we need to configure the web UI with the URI to the nipapd server. Edit
/etc/nipap/nipap.conf and set the option 'xmlrpc_uri' under the section
'[www]'. The URI should have the form
'<a class="reference external" href="http://">http://</a><em>username</em>:<em>password*&#64;*address</em>:<em>port</em>', for example
'<a class="reference external" href="http://www:secret&#64;127.0.0.1:9000">http://www:secret&#64;127.0.0.1:9000</a>' to connect to nipapd running on the local
machine (127.0.0.1) listening on port 9000 and authenticate with the username
'www' and password 'secret'.</p>
<p>For authentication, the NIPAP web UI uses the same authentication library and
settings as nipapd. That means, if they are running on the same machine they by
default use the same authentication database and the users can use the same
credentials for the web UI as for the backend. If they are not running on the
same machine, there will be two separate authentication databases; one for the
XML-RPC backend and one for the web UI.  Thus the web users needs to be added
on the machine where the web UI is running as well, using the 'nipap-passwd'
command as described above. These users does not need to be 'trusted' as above
though, so skip the '-t' option.</p>
</div>
<div class="section" id="serving-the-web-ui">
<h1>Serving the web UI</h1>
<p>The NIPAP web UI can be served by any WGSI-capable web server such as Apache
httpd with mod_wsgi. For quick tests and development the lightweight server
'paster', part of Python Paste, is handy.</p>
<div class="section" id="paster">
<h2>paster</h2>
<p>Using paster is the easiest way to get the NIPAP web UI up and running, but
it's not really suitable for deployment. Anyway, to serve the NIPAP web UI from
paster, simply run the following:</p>
<pre class="literal-block">
paster serve /etc/nipap/nipap-www.ini
</pre>
<p>Using the default configuration, the web UI should now be reachable on port
5000. To change the port, edit /etc/nipap/nipap-www.ini.</p>
</div>
<div class="section" id="apache-httpd-with-mod-wsgi">
<h2>Apache httpd with mod_wsgi</h2>
<p>Begin by installing Apache httpd with mod_wsgi:</p>
<pre class="literal-block">
apt-get install libapache2-mod-wsgi
</pre>
<p>Then, add a new virtual host or configure the default one with the line:</p>
<pre class="literal-block">
WSGIScriptAlias / /etc/nipap/nipap-www.wsgi
</pre>
<p>The web server needs to be able to write to its cache, alter the permissions of
/var/cache/nipap-www so that the web server can write to it and preferrably
also make sure no one else has access to it. For a typical Debian install of
Apache httpd, the following should suffice:</p>
<pre class="literal-block">
chown www-data:www-data /var/cache/nipap-www
chmod -R u=rwX /var/cache/nipap-www
</pre>
<p>Now, restart Apache httpd and the NIPAP web UI should be up and running!</p>
<p>That wraps up this getting started guide, for more information see the manual
pages.</p>
</div>
</div>
{% include footer.html %}
